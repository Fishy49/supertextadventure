<%= turbo_stream_from(@game, :messages) %>
<%= turbo_stream_from(@game, :state) %>
<%= turbo_stream_from(@game, :players) %>

<%= render "/messages/pager", game: @game, pagy: @pagy %>

<div id="game-messages" data-scroll-context-value="messages">
  <%= turbo_frame_tag(:messages) do %>
    <% @messages.reverse.each do |message| %>
      <%= render "/messages/message", message: message %>
    <% end %>
  <% end %>
</div>

<% content_for :text_form do %>
  <%= render(TerminalInputComponent.new(prompt: "", stimulus_controllers: ["game"], stimulus_values: { "game-id": @game.id, "game-user-id": @game.host?(current_user) ? :host : @game.game_user(current_user)&.id })) %>
<% end %>

<% content_for :sidebar do %>
  <h3 class="text-center"><strong><%= @game.name %></strong></h3>
  <div class="current-context">
    <%= render "current_context", game: @game %>
  </div>

  <h4 class="text-center mb-0 mt-3">PLAYERS</h4>
  <%= render "players", game_users: @game.game_users.order(:id) %>
<% end %>
